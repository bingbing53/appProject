(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-787b5f22"],{"2ed3":function(e,t,a){},"8b0d":function(e,t,a){"use strict";var r=a("2ed3"),s=a.n(r);s.a},"96ef":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{"background-color":"#f5f5f5"}},[r("van-row",[r("van-col",{attrs:{span:24}},[r("van-search",{attrs:{clearable:!1,placeholder:"输入姓名或身份证号","left-icon":"","right-icon":"search","show-action":""},scopedSlots:e._u([{key:"action",fn:function(){return[r("div",{on:{click:e.onSearch}},[e._v("搜索")])]},proxy:!0}]),model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1)],1),void 0!=e.userData.idcard?r("div",[r("div",{attrs:{id:"myCard"}},[r("van-row",[r("van-col",{attrs:{span:8}},[r("van-image",{attrs:{height:"120",id:"myAvatar",fit:"contain",src:null!=e.userData.headImage?e.common.showPicture(e.userData.headImage,"",!1):a(1==e.userData.sex?"690a":"8a9e"),radius:"20"}})],1),r("van-col",{attrs:{span:16}},[r("van-field",{attrs:{label:"姓名",placeholder:"请输入姓名",autosize:"",center:"","input-align":"right",required:""},model:{value:e.userData.personName,callback:function(t){e.$set(e.userData,"personName",t)},expression:"userData.personName"}}),r("van-cell",{attrs:{title:"性别",value:e.showData.sex,clickable:""},on:{click:function(t){return e.showNormalPicker("sex")}}}),r("van-field",{attrs:{label:"身份证号",placeholder:"请输入身份证号",autosize:"",center:"","input-align":"right",required:""},model:{value:e.userData.idcard,callback:function(t){e.$set(e.userData,"idcard",t)},expression:"userData.idcard"}})],1)],1),r("div",{attrs:{id:"line",block:""}}),r("van-cell",{attrs:{title:"出生日期",value:null==e.userData.birthdate?"点击选择出生日期":e.userData.birthdate,clickable:""},on:{click:function(t){e.showDatePicker=!0}}}),r("van-cell",{attrs:{title:"民族",value:e.showData.nationality,clickable:""},on:{click:function(t){return e.showNormalPicker("national")}}}),r("van-field",{attrs:{label:"联系方式",placeholder:"请输入联系方式",autosize:"",center:"","input-align":"right"},model:{value:e.userData.mobilePhone,callback:function(t){e.$set(e.userData,"mobilePhone",t)},expression:"userData.mobilePhone"}}),r("van-cell",{attrs:{title:"家庭关系",value:e.showData.hostRelation,clickable:""},on:{click:function(t){return e.showNormalPicker("host_relat")}}}),r("van-cell",{attrs:{title:"居住地址",value:e.userData.presentDetailAddr1,clickable:""},on:{click:e.clickToSelectAddress}}),r("van-field",{attrs:{label:"户籍地址",placeholder:"请输入户籍地址",autosize:"",center:"","input-align":"right"},model:{value:e.userData.rprDetailAddr,callback:function(t){e.$set(e.userData,"rprDetailAddr",t)},expression:"userData.rprDetailAddr"}}),r("van-cell",{attrs:{title:"文化程度",value:e.showData.eduLevel,clickable:""},on:{click:function(t){return e.showNormalPicker("edu_level")}}}),r("van-cell",{attrs:{title:"政治面貌",value:e.showData.polity,clickable:""},on:{click:function(t){return e.showNormalPicker("polity")}}})],1),r("van-row",[r("van-col",{attrs:{span:12,offset:"2"}},[r("van-button",{attrs:{round:"",color:"linear-gradient(to right, #55a5f9, #4b6bfa)",block:""},on:{click:e.saveInfo}},[e._v("保存")])],1),r("van-col",{attrs:{span:6,offset:"2"}},[r("van-button",{attrs:{round:"",plain:"",block:""},on:{click:e.deletePerson}},[e._v("删除")])],1)],1),r("van-action-sheet",{attrs:{title:""},model:{value:e.showDatePicker,callback:function(t){e.showDatePicker=t},expression:"showDatePicker"}},[r("van-datetime-picker",{attrs:{type:"date",title:"选择生日日期","min-date":e.minDate,"max-date":e.maxDate},on:{confirm:e.confirmDataPicker,cancel:function(t){e.showDatePicker=!1}},model:{value:e.currentDate,callback:function(t){e.currentDate=t},expression:"currentDate"}})],1),r("van-action-sheet",{attrs:{title:"选择性别",actions:e.actions},on:{select:e.onSelectSex},model:{value:e.showSexPicker,callback:function(t){e.showSexPicker=t},expression:"showSexPicker"}}),r("van-action-sheet",{attrs:{title:""},model:{value:e.showPicker,callback:function(t){e.showPicker=t},expression:"showPicker"}},[r("van-picker",{attrs:{"show-toolbar":"",columns:e.columns,"value-key":"typename"},on:{confirm:e.onNormalPickerConfirm,cancel:function(t){e.showPicker=!1}}})],1)],1):e._e()],1)},s=[],n=(a("163d"),a("6d57"),a("754d"),a("7c18")),i=(a("f548"),a("6a61"),a("cf7f")),o=(a("cc57"),a("9a33"),a("b2a8")),c=a("eb6a"),l={data:function(){return{keyword:"",userData:{},minDate:new Date(1900,0,1),maxDate:new Date,currentDate:new Date,showSexPicker:!1,showDatePicker:!1,showPicker:!1,actions:[{name:"男"},{name:"女"}],tagArray:["sex","national","host_relat","edu_level","polity"],dictionary:{},columns:[],currentPickerName:"",showData:{sex:"",nationality:"",hostRelation:"",eduLevel:"",polity:""}}},mounted:function(){console.log("mounted!"),console.log(this.keyword,"mounted!"),this.getDictionarys(),void 0!=this.$route.query.idcard&&(this.keyword=this.$route.query.idcard,""!=this.keyword&&this.getPersonData(this.keyword))},activated:function(){if(console.log("activated"),null!=window.localStorage.getItem("address_str")&&""!=window.localStorage.getItem("address_str")){this.userData.presentDetailAddr1=window.localStorage.getItem("address_str"),this.userData.address=window.localStorage.getItem("address"),this.userData.detailAddress=this.userData.presentDetailAddr1;var e=window.localStorage.getItem("address_arrdata");this.userData.buildingId=e.split(",")[2],this.userData.unitNo=e.split(",")[3],this.userData.houseNumber=e.split(",")[4],window.localStorage.setItem("address_str",""),window.localStorage.setItem("address",""),window.localStorage.setItem("address_arrdata","")}},beforeRouteLeave:function(e,t,a){"censusAddress"===e.name?(t.meta.keepAlive=!0,a()):(this.$destroy(),a())},methods:{getPersonData:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o["a"].getPersonData(t);case 2:a=e.sent,console.log(a,"111"),this.userData=JSON.parse(a)[0],void 0!=this.userData.birthdate&&(this.currentDate=new Date(this.userData.birthdate.replace(/-/,"/"))),console.log(this.userData),this.getDictionarys();case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),onSearch:function(){this.getPersonData(this.keyword)},confirmDataPicker:function(){var e=this.currentDate.getMonth()+1;this.userData.birthdate="".concat(this.currentDate.getFullYear(),"-").concat(e>=10?e:"0"+e,"-").concat(this.currentDate.getDate()),this.showDatePicker=!1},onSelectSex:function(e){this.userData.sex=e.name,this.showSexPicker=!1},saveInfo:function(){var e={personId:this.userData.id,name:this.userData.personName,sex:this.userData.sex,nationality:this.userData.nationality,mobilePhone:this.userData.mobilePhone,hostRelation:this.userData.hostRelation,rprDetailAddr:this.userData.rprDetailAddr,eduLevel:this.userData.eduLevel,polity:this.userData.polity,buildingId:this.userData.buildingId,unitNo:this.userData.unitNo,houseNumber:this.userData.houseNumber,address:this.userData.address,detailAddress:this.userData.detailAddress};this.doSave(e)},doSave:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o["a"].postUpdatePersonInfo(t);case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),deletePerson:function(){var e=this;n["a"].confirm({title:"确认",message:"确认删除".concat(this.userData.personName,"么")}).then((function(){console.log("确认删除"),e.deletePersonData()})).catch((function(){console.log("取消删除")}))},deletePersonData:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o["a"].deletePersonDataByPersonId(this.userData.id);case 2:e.sent,this.userData={};case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getDictionarys:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.t0=regeneratorRuntime.keys(this.tagArray);case 1:if((e.t1=e.t0()).done){e.next=13;break}return t=e.t1.value,a=this.tagArray[t],e.next=6,c["a"].getDictionary(a);case 6:r=e.sent,r=JSON.parse(r),s=r[a],s.splice(0,0,{typecode:"-1",typename:"请选择"}),this.dictionary[a]=s,e.next=1;break;case 13:this.dealUserData();case 14:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),showNormalPicker:function(e){this.currentPickerName=e;var t=this.dictionary[e];this.columns=t,this.showPicker=!0},onNormalPickerConfirm:function(e){switch(this.showPicker=!1,this.currentPickerName){case"sex":this.userData.sex=e.typecode,this.showData.sex=e.typename;break;case"national":this.userData.nationality=e.typecode,this.showData.nationality=e.typename;break;case"host_relat":this.userData.hostRelation=e.typecode,this.showData.hostRelation=e.typename;break;case"edu_level":this.userData.eduLevel=e.typecode,this.showData.eduLevel=e.typename;break;case"polity":this.userData.polity=e.typecode,this.showData.polity=e.typename;break;default:break}},dealUserData:function(){if(null!=this.userData)for(var e in this.tagArray){var t=this.tagArray[e],a=this.dictionary[t];for(var r in a)switch(t){case"sex":Number(a[r].typecode)==Number(this.userData.sex)&&(this.showData.sex=a[r].typename);break;case"national":Number(a[r].typecode)==Number(this.userData.nationality)&&(this.showData.nationality=a[r].typename);break;case"host_relat":Number(a[r].typecode)==Number(this.userData.hostRelation)&&(this.showData.hostRelation=a[r].typename);break;case"edu_level":Number(a[r].typecode)==Number(this.userData.eduLevel)&&(this.showData.eduLevel=a[r].typename);break;case"polity":Number(a[r].typecode)==Number(this.userData.polity)&&(this.showData.polity=a[r].typename);break;default:break}}},clickToSelectAddress:function(){console.log("clickToSelectAddress"),this.$router.push({path:"/censusAddress",query:{}})}}},u=l,d=(a("8b0d"),a("9ca4")),h=Object(d["a"])(u,r,s,!1,null,null,null);t["default"]=h.exports}}]);